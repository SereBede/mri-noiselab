<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; mri_noiselab 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=2709fde1"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="mri-noiselab" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-mri_noiselab">
<span id="api-reference"></span><h1>API Reference<a class="headerlink" href="#module-mri_noiselab" title="Link to this heading">¶</a></h1>
<p>Rayleigh noise estimation and subtraction for MRI magnitude images.</p>
<p>This module provides utilities to estimate and remove Rayleigh-distributed
noise from magnetic resonance (MRI) magnitude images using a background-based
approach derived from the Rician noise model.</p>
<p>The public functions are:</p>
<ul class="simple">
<li><p>subtract_noise</p></li>
<li><p>subtract_noise_masked</p></li>
</ul>
<p>The module is designed for research and educational purposes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="mri_noiselab.subtract_noise">
<span class="sig-prename descclassname"><span class="pre">mri_noiselab.</span></span><span class="sig-name descname"><span class="pre">subtract_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">np_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mri_noiselab.html#subtract_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mri_noiselab.subtract_noise" title="Link to this definition">¶</a></dt>
<dd><p>Perform pixel-wise Rayleigh noise reduction on MRI magnitude images.</p>
<p>Noise is estimated from a background region assumed to contain
Rayleigh-distributed noise and removed using a magnitude correction
derived from the Rician noise model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.ndarray.</em>) – Input magnitude image. Values must be finite and non-negative.
Can be N-dimensional as biomedical images.</p></li>
<li><p><strong>bg_area</strong> (<em>numpy.ndarray</em>) – Background region containing only noise (no signal).
Values must be finite and non-negative.</p></li>
<li><p><strong>b_tol</strong> (<em>float, optional</em>) – Absolute tolerance used to assess deviation of the background
mean-to-standard-deviation ratio from 1.91, the expected Rayleigh value.
Default is 0.1</p></li>
<li><p><strong>f_size</strong> (<em>int, optional</em>) – Size of the local window (in pixel) used to compute mean and variance.
Default is 10.</p></li>
<li><p><strong>np_type</strong> (<em>numpy.dtype, optional</em>) – The numpy data type to be used during computation.
Default is np.float32</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>A</strong> – Noise-corrected image with the same shape as <cite>image</cite>.
Output values are non-negative.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If the input is not a numpy.ndarray (masked arrays must be handled via subtract_noise_masked)</p></li>
<li><p><strong>ValueError</strong> – If background region has negative values.</p></li>
<li><p><strong>ValueError</strong> – If input image has negative values.</p></li>
<li><p><strong>ValueError</strong> – If background region is entirely zero (all pixels == 0).</p></li>
<li><p><strong>ValueError</strong> – If input image is entirely zero (all pixels == 0).</p></li>
<li><p><strong>ValueError</strong> – If background has zero standard deviation (noiseless values).</p></li>
<li><p><strong>RuntimeError</strong> – If numpy encounters overflow, invalid, zero division, underflow.</p></li>
</ul>
</dd>
<dt class="field-odd">Warns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>RuntimeWarning</strong> – If image standard deviation is zero (uniform noisless image).</p></li>
<li><p><strong>RuntimeWarning</strong> – If ratio of background average and standard deviation differs from 1.91,
as expected in a Rayleigh distribution.</p></li>
<li><p><strong>RuntimeWarning</strong> – If negative values are produced by the correction and are clamped to zero.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The algorithm assumes spatially stationary Rayleigh noise.</p></li>
<li><p>Masked arrays must be handled via :func:’subtract_noise_masked’</p></li>
<li><p>Negative input values are not supported; they must be masked or removed
prior to calling this function.</p></li>
<li><p>Background area can be a slice of the input image or a separate array.</p></li>
<li><p>Background size and shape may differ from image.</p></li>
<li><p>The choice of ‘f_size’ affects the trade-off between noise reduction and
spatial resolution.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Load an MRI magnitude image from a DICOM file, estimate noise from a
background region, and apply noise correction:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pydicom</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mri_noiselab</span><span class="w"> </span><span class="kn">import</span> <span class="n">subtract_noise</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">pydicom</span><span class="o">.</span><span class="n">dcmread</span><span class="p">(</span><span class="s2">&quot;example_mri.dcm&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pixel_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># Select a background region (noise only)</span>
<span class="n">background</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>

<span class="n">corrected</span> <span class="o">=</span> <span class="n">subtract_noise</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mri_noiselab.subtract_noise_masked">
<span class="sig-prename descclassname"><span class="pre">mri_noiselab.</span></span><span class="sig-name descname"><span class="pre">subtract_noise_masked</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_ma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bg_ma</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_masked</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mri_noiselab.html#subtract_noise_masked"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mri_noiselab.subtract_noise_masked" title="Link to this definition">¶</a></dt>
<dd><p>Apply Rayleigh noise subtraction to a masked image.</p>
<p>This wrapper enables the use of numpy masked arrays with the
<a class="reference internal" href="#mri_noiselab.subtract_noise" title="mri_noiselab.subtract_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">subtract_noise()</span></code></a> function, which does not natively support masks.</p>
<p>Useful in case segmentation is provided or to hide problematic pixels.</p>
<p>Masked pixels are temporarily filled with a constant value for the
numerical computation and the original mask is restored on output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_ma</strong> (<em>numpy.ma.MaskedArray</em>) – Input image as a masked array. Masked pixels are excluded from
validation checks and restored in the output.</p></li>
<li><p><strong>bg_ma</strong> (<em>numpy.ndarray or numpy.ma.MaskedArray</em>) – Background region used for noise estimation. If masked, only
unmasked values are used to compute statistics.</p></li>
<li><p><strong>fill_value</strong> (<em>float, optional</em>) – Value used to fill masked pixels before computation.
Default is 0.0 (it will affect local mean and std at borders).</p></li>
<li><p><strong>return_masked</strong> (<em>bool, optional</em>) – If True, return a masked array with the same mask as <cite>image_ma</cite>.
If False, return a regular numpy.ndarray.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments forwarded to <cite>subtract_noise</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Noise-corrected image. Masked if <cite>return_masked=True</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray or numpy.ma.MaskedArray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – If <cite>image_ma</cite> is not a numpy.ma.MaskedArray.</p></li>
<li><p><strong>ValueError</strong> – If the background has no valid (unmasked) pixels.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Noise correction is still computed over the full image extent.</p></li>
<li><p>Masking only affects validation, background statistics, and the output mask.</p></li>
<li><p>Use <cite>fill_value</cite> carefully to minimize boundary artifacts.</p></li>
</ul>
<p class="rubric">Examples</p>
<p>Apply noise correction to a DICOM image using a masked array to exclude
invalid pixels:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pydicom</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy.ma</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ma</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mri_noiselab</span><span class="w"> </span><span class="kn">import</span> <span class="n">subtract_noise_masked</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">pydicom</span><span class="o">.</span><span class="n">dcmread</span><span class="p">(</span><span class="s2">&quot;example_mri.dcm&quot;</span><span class="p">)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pixel_array</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">mask</span> <span class="o">=</span> <span class="n">image</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<span class="n">image_ma</span> <span class="o">=</span> <span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

<span class="n">background</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
<span class="n">corrected</span> <span class="o">=</span> <span class="n">subtract_noise_masked</span><span class="p">(</span><span class="n">image_ma</span><span class="p">,</span> <span class="n">background</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">mri_noiselab</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mri_noiselab.subtract_noise"><code class="docutils literal notranslate"><span class="pre">subtract_noise()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="#mri_noiselab.subtract_noise_masked"><code class="docutils literal notranslate"><span class="pre">subtract_noise_masked()</span></code></a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">mri-noiselab</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2026, Serena Bedeschi.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>